<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, $rootScope, spUtil) {
  var c = this;
	
//	$rootScope.hasRequestsOrApprovals = c.data.request.hasAny || c.data.approvals.hasAny;
	$rootScope.hasRequestsOrApprovals = false;
	
	this.KEYS = {
						DOWN:40,
						LEFT:37,
						RIGHT:39,
						TAB:9,
						UP:38
					 };

	$scope.show_quicklink = true;
	$scope.show_request = false;
	$scope.show_requestOth = false;
	$scope.show_approvals = false;
	$scope.show_assigned = false;
	
	//RES:: 
	$scope.iconClass = '';

	c.data.titleQL = "Home";
	
	$scope.changePanel = function(panel_name) {
		
		if (panel_name == 'request') {
			$scope.show_quicklink = false;
			$scope.show_request = true;
			$scope.show_approvals = false;
			$scope.show_requestOth = false;
			$scope.show_assigned = false;
			$('a.request').focus();
			
		} else if (panel_name == 'quicklink') {
			$scope.show_quicklink = true;
			$scope.show_request = false;
			$scope.show_approvals = false;
			$scope.show_requestOth = false;
			$scope.show_assigned = false;
			$('a.quicklink').focus();
			
		} else if (panel_name == 'requestOth') {
			$scope.show_quicklink = false;
			$scope.show_requestOth = true;
			$scope.show_request = false;
			$scope.show_approvals = false;
			$scope.show_assigned = false;
			$('a.requestOth').focus();
			
		} else if (panel_name == 'assigned') {
			$scope.show_quicklink = false;
			$scope.show_requestOth = false;
			$scope.show_request = false;
			$scope.show_approvals = false;
			$scope.show_assigned = true;
			$('a.assigned').focus();
		
		} else {
			$scope.show_request = false;
			$scope.show_requestOth = false;
			$scope.show_quicklink = false;
			$scope.show_approvals = true;
			$scope.show_assigned = false;
			$('a.approval').focus();
		}
		
	};
	
	if (c.data.showApprovals)
		spUtil.recordWatch($scope, "sysapproval_approver", "state=requested^approverIN" +  $scope.data.approvals.myApprovals.toString());
	
	function get() {
		spUtil.update($scope);
	}

	$scope.approve = function(id) {
		$scope.data.op = "approved";
		$scope.data.target = id;
		get();
	};

	$scope.reject = function(id) {
		$scope.data.op = "rejected";
		$scope.data.target = id;
		get();
	};
	
	$scope.switchTab = function($event, tab) {
		var key = null;
		if (event.keyCode === c.KEYS.LEFT || event.keyCode === c.KEYS.UP)
			key = c.KEYS.LEFT;
		else if (event.keyCode === c.KEYS.RIGHT || event.keyCode === c.KEYS.DOWN)
			key = c.KEYS.RIGHT;
		else if (event.keyCode === c.KEYS.TAB) {
			return;
		}
		if (key === null)
			return;
	
		if (!c.data.approvals.hasAny) {
			
		}
		
		if (tab == 'request') {
			$scope.show_quicklink = false;
			$scope.show_request = true;
			$scope.show_approvals = false;
			$scope.show_requestOth = false;
			$scope.show_assigned = false;
			$('a.request').focus();
			
		} else if (tab == 'requestOth') {
			$scope.show_request = false;
			$scope.show_requestOth = true;
			$scope.show_quicklink = false;
			$scope.show_approvals = false;
			$scope.show_assigned = false;
			$('a.requestOth').focus();
			
		} else if (tab == 'quicklink') {
			$scope.show_request = false;
			$scope.show_quicklink = true;
			$scope.show_approvals = false;
			$scope.show_requestOth = false;
			$scope.show_assigned = false;
			$('a.quicklink').focus();

		} else if (tab == 'assigned') {
			$scope.show_request = false;
			$scope.show_quicklink = false;
			$scope.show_approvals = false;
			$scope.show_requestOth = false;
			$scope.show_assigned = true;
			$('a.quicklink').focus();
			
		} else {
			$scope.show_request = false;
			$scope.show_quicklink = false;
			$scope.show_approvals = true;
			$scope.show_requestOth = false;
			$scope.show_assigned = false;
			$('a.approval').focus();
		}
		
	}

}
]]></client_script>
        <controller_as>c</controller_as>
        <css>// My Stuff Home Page Widget

@media only screen and (max-width : 991px) {
	.panels-container {
 	  min-height : 240px;
	}
}

@media only screen and (min-width : 992px) {
	.panels-container {
 	  min-height : 240px;
	}
}

@media only screen and (max-width : 700px) {
	.ssp-panel-widget {
 	  height : 95%;
	}
}

.panel-body {
	min-height: 285px; 
}

.panel-heading {
    background-color: #F8F8F8;
}

.list-group-links {
	padding-top: 10px;
}

.panels-container-links {
  margin-bottom: 10px;
}
.panels-container-requests {
  margin-bottom: 0px;
}
.panels-container-approval {
  margin-bottom: 0px;
}

.overflow-links {
  margin-top: 10px;
  height : 220px;
  max-height : 220px;
	overflow: auto;
}
.overflow-requests {
  height : 235px !important;
  //max-height : 255px;
	overflow: auto;
}
.overflow-approvals {
  height : 255px !important;
  max-height : 255px;
	overflow: auto;
}
.sp-approval &gt; .approval-rows {
  padding: 10px;
}

.sc-tab-a {
    color: #428bca;
    border: 0;
    border-bottom: 3px solid #428bca;
}

.nav &gt; li &gt; a:focus {
    background-color: #ffffff !important;
    text-decoration: underline;
}
.nav &gt; li &gt; a:hover {
    background-color: #ffffff !important;
    text-decoration: underline;
}

a.quicklink i.fa{
	text-align: left;
  margin: 0px 4px;
  color: #428bca;
}

a.quicklink i.fa + span{
	margin-left: 12px;
}

.esdHeader {
	font-weight: bold;
  font-size: 1.25em;
  text-align: center;
}

.esdBody {
  text-align: center;
}

.esdSubBody {
	// font-weight: bold;
  // font-size: 1.25em;
  text-align: center;
  margin-top: -10px;
  margin-bottom: -1px;
}


.esdSubPanel {
  border-radius: 25px;
  border: 1px solid $brand-info;
  padding: 3px;
}

//RES:: bootstrap overrides
div.ssp-panel-heading.panel-heading{
	padding-bottom: 0px;
  padding-top: 0px;
  min-height: 50px;
}

div.ssp-panel-heading.panel-heading ul.nav.nav-tabs{
	//margin-top: 10px;
}

div.ssp-panel-heading.panel-heading ul.nav.nav-tabs li a{
	padding-left: 8px;
  padding-right: 8px;
  margin-top: 6px;
  
}

div.ssp-panel-heading.panel-heading ul.nav.nav-tabs li a span{
  font-size: 16px;
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>ssp_my_stuff_v2</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>SSP My Stuff v2</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {

	if (input) {
		if (input.op == 'approved' || input.op == 'rejected') {
			var app = new GlideRecord("sysapproval_approver");
			if (app.get(input.target) && app.state.canWrite()) {
				app.state = input.op;
				app.update();
			}
		}
	}

	data.svcCategories = [
		"Agency Specific",
		"Account and Facility Access",
		"Desktop and Phone",
		"IT Operations",
		"Modern Workplace"
	];
	
	// Use SSP MyStuff Util to fill
	// the various link lists
	var msu = new SSPMyStuffUtil();
	data.agencyLinks = msu.getLinkListByCategory("agencyLinks");
	data.mainLinks = msu.getLinkListByCategory("mainLinks");
	data.accessLinks = msu.getLinkListByCategory("accessLinks");
	data.desktopLinks = msu.getLinkListByCategory("desktopLinks");
	data.itOpsLinks = msu.getLinkListByCategory("itOpsLinks");
	data.modernLinks = msu.getLinkListByCategory("modernLinks");

	data.uDept = msu.getUserDepartment();	
	
	
	var slAnnOpts = {
			"title" : "Announcements",
			"table" : "kb_knowledge",
			"filter" : "active=true^ORDERBYDESCnumber^topic=News^workflow_stateINpublished^valid_to>=javascript:gs.beginningOfToday()",
			"display_field" : "short_description",
			"sp_page" : "kb_article",
			"secondary_fields": "number,sys_updated_on",
		  "always_show": true,
			// "glyph" : "calendar",
			// "view": "5daaf5116f2201002265bc226e3ee455",		
			"maximum_entries" : 5
	};
	
	var contactUpOpts = {
		"title": "Contact Information Update", 
		"showHeading": true,  /* if left blank, defaults to true*/
		"showMessage": true,  /* if left blank, defaults to true*/
		"displayMessage": "", /* Text message to be shown */
		"link": "epsp?id=sc_cat_item&sys_id=dcedc6f5db7f88d0b83e790aaf96197e&sysparm_category=4d948f6d6f0a15007d1f35af1e3ee4ff",
		"linkText": "" /*defaults to Click Here to Update in all uppercase */
	};
	
	data.wConUpdate = $sp.getWidget("epsp_contact_info_update", contactUpOpts);
	
	data.wAltStatus = $sp.getWidget("widget-simple-list", slAnnOpts);

	// Determine if user has any Incident assignments
	function getMyAssigned () {
		var gr = new GlideRecord("task");
		gr.addActiveQuery();
		gr.addQuery('assigned_to', gs.getUserID());
		gr.query();
		
		var rec = {};
		
		while (gr.next()) {
			rec = {};
			rec.display_field = gr.getDisplayValue("short_description");
			rec.updated_on = gr.getValue('sys_updated_on');
			rec.secondary_displays = [
				{"display_value" : gr.getDisplayValue('number')},
				{"display_value" : gr.getDisplayValue('state')}
			];
			rec.url = {
				"id" : "ticket",
				"table" : "incident",
				"sys_id" : gr.getValue('sys_id')
			};
			
			data.assigned.req_list.push(rec);
		}
		if (data.assigned.req_list.length > 0) {
			data.assigned.hasAny = true;
		}
	}
	
	// If ITIL User, get any assigned incident tasks
	data.assigned = {};
	data.assigned.req_list = [];
	data.assigned.hasAny = false;
	if (gs.getUser().hasRole('itil')) {
		getMyAssigned();	
	}
	
	
	function getField(gr, name) {
		var f = {};
		var id = gr.getUniqueValue();
		gr = new GlideRecord(gr.getRecordClassName());
		gr.get(id);
		f.display_value = gr.getDisplayValue(name);
		f.value = gr.getValue(name);
		var ge = gr.getElement(name);
		if (ge) {
			var ed = ge.getED();
			if (ed)
				f.type = ed.getInternalType();
			f.label = ge.getLabel();
		}
		return f;
	}

	function getMyRequestSysIds() {
		var ids = {};
		var rq_filter = new GlideRecord('request_filter');
		rq_filter.addActiveQuery();
		rq_filter.addEncodedQuery('title=EPSP Incident Portal^ORtitle=EPSP Service Catalog Portal')
		if (rq_filter.isValidField('applies_to'))
			rq_filter.addQuery('applies_to', 1).addOrCondition('applies_to', 10);
		rq_filter.query();
		while(rq_filter.next()) {
			var tableName = rq_filter.table_name;
			if (rq_filter.isValidField('table'))
				tableName = rq_filter.table;
			var gr = new GlideRecord(tableName);
			gr.addQuery(rq_filter.filter);
			gr.query();
			while(gr.next()) {
				var portalSettings = {};
				portalSettings.page = rq_filter.portal_page.nil()? '' : rq_filter.portal_page.getDisplayValue() + '';
				portalSettings.primary_display = rq_filter.primary_display.nil()? '': rq_filter.primary_display + '';
				portalSettings.secondary_displays = rq_filter.secondary_display.nil()? '': rq_filter.secondary_display + '';
				ids[gr.sys_id + ''] = portalSettings;
			}
		}
		return ids;
	}

	function getMyOthersSysIds() {
		var ids = {};
		var rq_filter = new GlideRecord('request_filter');
		rq_filter.addActiveQuery();
		rq_filter.addEncodedQuery('title=EPSP Incident Portal Others^ORtitle=EPSP Service Catalog Portal Others')
		if (rq_filter.isValidField('applies_to'))
			rq_filter.addQuery('applies_to', 1).addOrCondition('applies_to', 10);
		rq_filter.query();
		while(rq_filter.next()) {
			var tableName = rq_filter.table_name;
			if (rq_filter.isValidField('table'))
				tableName = rq_filter.table;
			var gr = new GlideRecord(tableName);
			gr.addQuery(rq_filter.filter);
			gr.query();
			while(gr.next()) {
				var portalSettings = {};
				portalSettings.page = rq_filter.portal_page.nil()? '' : rq_filter.portal_page.getDisplayValue() + '';
				portalSettings.primary_display = rq_filter.primary_display.nil()? '': rq_filter.primary_display + '';
				portalSettings.secondary_displays = rq_filter.secondary_display.nil()? '': rq_filter.secondary_display + '';
				ids[gr.sys_id + ''] = portalSettings;
			}
		}
		return ids;
	}

	
	function getMyApprovalsIds() {
		var u = gs.getUserID();
		var answer = [];
		var i = 0;
		answer[i++] = u + '';
		var g = new GlideRecord("sys_user_delegate");
		g.addQuery("delegate", u);
		g.addQuery("approvals", "true");
		g.addQuery("starts", "<=", gs.daysAgo(0));
		g.addQuery("ends", ">=", gs.daysAgo(0));
		g.query();
		while( g.next())
			answer[i++] = g.user + '';
		return answer;
	}

	// retrieve the Users request's
	var myRequestMap = getMyRequestSysIds();
	var taskIDs = Object.keys(myRequestMap);
	var gr = new GlideRecordSecure('task');
	gr.addActiveQuery();
	gr.addQuery('sys_id', taskIDs);
	gr.orderByDesc('sys_created_on');
	gr.chooseWindow(0,11);
	gr.query();

	data.request = {};
	data.approvals = {};
	
	data.request.hasAny = false;
	data.approvals.hasAny = false;
	
	data.request.req_list = [];
	var recordIdx = 0;

	while (gr.next()) {
		if (recordIdx == 10)
			break;
		var portalSettings = myRequestMap[gr.getUniqueValue()];
		if (typeof portalSettings == 'undefined')
			portalSettings = {};

		var record = {};
		record.sys_id = gr.getValue('sys_id');

		if (gr.getRecordClassName() == 'sc_request') {
			var ritm = new GlideRecord("sc_req_item");
			ritm.addQuery("request", gr.getUniqueValue());
			ritm.query();
			if (ritm.getRowCount() == 0)
				continue;
			if (ritm.getRowCount() > 1)
				record.display_field = gs.getMessage("{0} requested items", ritm.getRowCount());
			else {
				ritm.next();
				record.display_field = ritm.cat_item.getDisplayValue() || ritm.getDisplayValue("short_description");
			}
			record.url = { id: portalSettings.page? portalSettings.page: 'sc_request', table: 'sc_request', sys_id: record.sys_id};
		} else {
			record.display_field = portalSettings.primary_display ? getField(gr, portalSettings.primary_display).display_value : getField(gr, 'number').display_value;
			record.url = { id: portalSettings.page? portalSettings.page :'ticket', table: gr.getRecordClassName(), sys_id: record.sys_id};
		}
		if (portalSettings.secondary_displays) {
			record.secondary_displays = [];
			portalSettings.secondary_displays.split(",").forEach(function (sDisplay){
				record.secondary_displays.push(getField(gr, sDisplay));
			});
		}
		else 
			record.secondary_displays = getField(gr, 'short_description');

		record.updated_on = gr.getValue('sys_updated_on');
		data.request.req_list.push(record);
		recordIdx++;
	}

	if (recordIdx == 10 && gr.isValidRecord())
		data.request.maximum_entries = true;
	data.request.hasAny = data.request.req_list.length > 0 ? true : false;
	

	
	// retrieve the Users requests for Others
	myRequestMap = getMyOthersSysIds();
	taskIDs = Object.keys(myRequestMap);
	gr = new GlideRecordSecure('task');
	gr.addActiveQuery();
	gr.addQuery('sys_id', taskIDs);
	gr.orderByDesc('sys_created_on');
	gr.chooseWindow(0,11);
	gr.query();

	data.requestOth = {};
	data.requestOth.hasAny = false;
	
	data.requestOth.req_list = [];
	recordIdx = 0;

	while (gr.next()) {
		if (recordIdx == 10)
			break;
		var portalSettings = myRequestMap[gr.getUniqueValue()];
		if (typeof portalSettings == 'undefined')
			portalSettings = {};

		var record = {};
		record.sys_id = gr.getValue('sys_id');

		if (gr.getRecordClassName() == 'sc_request') {
			var ritm = new GlideRecord("sc_req_item");
			ritm.addQuery("request", gr.getUniqueValue());
			ritm.query();
			if (ritm.getRowCount() == 0)
				continue;
			if (ritm.getRowCount() > 1)
				record.display_field = gs.getMessage("{0} requested items", ritm.getRowCount());
			else {
				ritm.next();
				record.display_field = ritm.cat_item.getDisplayValue() || ritm.getDisplayValue("short_description");
			}
			record.url = { id: portalSettings.page? portalSettings.page: 'sc_request', table: 'sc_request', sys_id: record.sys_id};
		} else {
			record.display_field = portalSettings.primary_display ? getField(gr, portalSettings.primary_display).display_value : getField(gr, 'number').display_value;
			record.url = { id: portalSettings.page? portalSettings.page :'ticket', table: gr.getRecordClassName(), sys_id: record.sys_id};
		}
		if (portalSettings.secondary_displays) {
			record.secondary_displays = [];
			portalSettings.secondary_displays.split(",").forEach(function (sDisplay){
				record.secondary_displays.push(getField(gr, sDisplay));
			});
		}
		else 
			record.secondary_displays = getField(gr, 'short_description');

		record.updated_on = gr.getValue('sys_updated_on');
		data.requestOth.req_list.push(record);
		recordIdx++;
	}

	if (recordIdx == 10 && gr.isValidRecord())
		data.requestOth.maximum_entries = true;
	data.requestOth.hasAny = data.requestOth.req_list.length > 0 ? true : false;
	
	
	
	
	// fetch approvals for the user.
	// data.showApprovals = gs.getUser().hasRole('approver_user');
	data.showApprovals = true;
	
	// Retreive approvals related to the User.
	if (data.showApprovals) {
		gr = new GlideRecord('sysapproval_approver');
		gr.chooseWindow(0, 10);
		var qc1 = gr.addQuery("state", "requested");
		data.approvals.myApprovals = getMyApprovalsIds();
		gr.addQuery("approver", data.approvals.myApprovals);
		gr.orderBy("sys_created_on");
		gr.query();

		var approvalsCount = gr.getRowCount();
		var approvals = [];
		var ids = [];

		while (gr.next()) {
			var task = getRecordBeingApproved(gr);
			if (!task.isValidRecord())
				continue;

			ids.push(gr.getUniqueValue());
			var t = {};
			t.number = task.getDisplayValue();
			t.short_description = task.short_description.toString();
			if (gr.getValue("approver") != gs.getUserID())
				t.approver = gr.approver.getDisplayValue();
			if (task.isValidField("opened_by") && !task.opened_by.nil())
				t.opened_by = task.opened_by.getDisplayValue();
			// requestor >> opener
			if (task.isValidField("requested_by") && !task.requested_by.nil())
				t.opened_by = task.requested_by.getDisplayValue();

			t.start_date = task.getDisplayValue('start_date');
			t.end_date = task.getDisplayValue('end_date');
			t.quantity = task.getDisplayValue('quantity');
			t.table = task.getLabel();
			if (task.getValue("price") > 0)
				t.price = task.getDisplayValue("price");

			if (task.getValue("recurring_price") > 0)
				t.recurring_price = task.getDisplayValue("recurring_price");

			t.recurring_frequency = task.getDisplayValue("recurring_frequency");

			var items = [];
			var idx = 0;
			var itemsGR = new GlideRecord("sc_req_item");
			itemsGR.addQuery("request", task.sys_id);
			itemsGR.query();
			if (itemsGR.getRowCount() > 1)
				t.short_description = itemsGR.getRowCount() + " requested items";

			while (itemsGR.next()) {
				var item = {};
				item.short_description = itemsGR.short_description.toString();
				if (itemsGR.getValue("price") > 0)
					item.price = itemsGR.getDisplayValue("price");
				if (itemsGR.getValue("recurring_price") > 0) {
					item.recurring_price = itemsGR.getDisplayValue("recurring_price");
					item.recurring_frequency = itemsGR.getDisplayValue("recurring_frequency");
				}
				if (itemsGR.getRowCount() == 1) {
					item.variables = $sp.getRecordVariablesArray(itemsGR);
					t.short_description = itemsGR.short_description.toString();
				}

				items[idx] = item;
				idx++;
			}

			var j = {};
			j.sys_id = gr.getUniqueValue();
			j.table = gr.getRecordClassName();
			j.task = t;
			if (task) {
				var optionsGr = task.request_item ? task.request_item.getRefRecord() : task;
				j.variables = $sp.getRecordVariablesArray(optionsGr);
			}

			j.items = items;
			j.state = gr.getValue("state");
			j.stateLabel = gr.state.getDisplayValue();
			approvals.push(j);
		}

		data.approvals.ids = ids;
		data.approvals.approval_list = approvals;
		if (approvals.length > 10)
			data.approvals.show_viewAll = true;

		data.approvals.hasAny = approvals.length > 0 ? true : false;
	}

	function getRecordBeingApproved(gr) {
		if (!gr.sysapproval.nil())
			return gr.sysapproval.getRefRecord();
		return gr.document_id.getRefRecord();
	}

})();

]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admindavid</sys_created_by>
        <sys_created_on>2020-08-27 16:12:55</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>1e7471c3dbbed89089aa05d2ca9619b3</sys_id>
        <sys_mod_count>181</sys_mod_count>
        <sys_name>SSP My Stuff v2</sys_name>
        <sys_package display_value="PersonaPortal" source="x_saico_eppersona">d2c8b27cdb4e981036d27e09af961908</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="PersonaPortal">d2c8b27cdb4e981036d27e09af961908</sys_scope>
        <sys_update_name>sp_widget_1e7471c3dbbed89089aa05d2ca9619b3</sys_update_name>
        <sys_updated_by>admindavid</sys_updated_by>
        <sys_updated_on>2020-12-18 12:50:25</sys_updated_on>
        <template><![CDATA[<div class="panel panel-default panel-links">
<!--  <div class="panel panel-default xssp-panel-widget" ng-if = "$root.hasRequestsOrApprovals || $root.hasSavedCarts"> -->
  
 	<div class="ssp-panel-heading panel-heading panel-heading-links pad-bottom pad-bottom-links">
    	<ul class="nav nav-tabs nav-tabs-links" style="border-bottom: 0px;" role="tablist">
      	<li class="item" role="tab" tabindex="-1" ng-click="changePanel('quicklink')" ng-keydown="switchTab($event, 'quicklink')">
        	<a ng-class="{'sc-tab-a' : show_quicklink, 'ssp-selected': show_quicklink}" href="javascript:void(0)" class="quicklink">
          	<i ng-if="(c.data.iconClass).length>0" class="fa fa-stack-1x fa-inverse ssp-btn-widget-icon" ng-class="c.data.iconClass"></i><span> {{c.data.titleQL}} </span>
          </a>
        </li>  
      	<li ng-if="c.data.request.hasAny == true" class="item" role="tab" tabindex="1" ng-click="changePanel('request')" ng-keydown="switchTab($event, 'request')">
        	<a ng-class="{'sc-tab-a' : show_request, 'ssp-selected': show_request}" href="javascript:void(0)" class="request">
          	<span> ${My Tickets} </span>
          </a>
        </li>  
      	<li ng-if="c.data.requestOth.hasAny == true" class="item" role="tab" tabindex="1" ng-click="changePanel('requestOth')" ng-keydown="switchTab($event, 'requestOth')">
        	<a ng-class="{'sc-tab-a' : show_requestOth, 'ssp-selected': show_requestOth}" href="javascript:void(0)" class="requestOth">
          	<span> ${Opened by Me} </span>
          </a>
        </li>  
        <li ng-if = "c.data.assigned.hasAny" class="item" role="tab" tabindex="2" ng-click="changePanel('assigned')" ng-keydown="switchTab($event, 'assigned')">
        	<a ng-class="{'sc-tab-a' : show_assigned, 'ssp-selected': show_assigned}" href="javascript:void(0)" class="assigned">
          	<span > Assigned to Me </span>
          </a>
        </li>  
        <li ng-if = "c.data.approvals.hasAny && c.data.showApprovals" class="item" role="tab" tabindex="2" ng-click="changePanel('approval')" ng-keydown="switchTab($event, 'approval')">
        	<a ng-class="{'sc-tab-a' : show_approvals, 'ssp-selected': show_approvals}" href="javascript:void(0)" class="approval">
          	<span > ${My Approvals} </span>
          </a>
        </li>  
    	</ul>
  </div>
  
  <div class="panel-body"> 
  
  <!-- Home Panel -->
  <div ng-if="show_quicklink " class="panels-container-links">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-6">
          <div style="margin-top:20px;">
              <p class="esdBody esdSubPanel">
                <span class="esdHeader">Central IT Service Desk</span><br/>
                <strong>(844) 834-2449</strong> -or- <strong>(714) 4IT-HELP</strong><br/>
                <a href="/oc?id=sc_category&catalog_id=866b692f4fc01340a6bd5f211310c703&sys_id=0ec4cf6d6f0a15007d1f35af1e3ee428"><b>Report an Issue Online</b></a>
              </p>
            <div style="padding-top:10px;">
              <p class="esdHeader">Contact Information Update</p>
              <p class="esdSubBody">
                Please update your contact information (best contact number) 
                to ensure we can reach you to fulfill your request 
                in a timely manner.
              </p>
              <p class="esdBody">
                <a href="/oc?id=sc_cat_item&sys_id=dcedc6f5db7f88d0b83e790aaf96197e&sysparm_category=4d948f6d6f0a15007d1f35af1e3ee4ff"><strong>Click Here to Update</strong></a>
              </p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 overflow-links">
          <!-- Status Msg --> 
          <sp-widget widget="c.data.wAltStatus"></sp-widget>
          <!-- /Status Msg -->       
        </div>
      </div>
    </div>
  </div>

  <!-- Requests Panel -->
  <div ng-if = "show_request && c.data.request.hasAny == true && !show_quicklink && !show_approvals && !show_assigned" class="panels-container-requests overflow-requests list-group">
    	<div class="list-group-item row" ng-repeat="item in c.data.request.req_list" style="margin:0px;" >
      		<div class="col-xs-8" style="">
            <div>
             <a href="?id={{::item.url.id}}&table={{::item.url.table}}&sys_id={{::item.url.sys_id}}"> {{::item.display_field}} </a>
            </div>
            <small class="text-muted">
            	<div ng-repeat="f in item.secondary_displays">
            			<span>{{::f.display_value}}</span>
              </div>
            </small>
          </div>
         	<div class="col-xs-4">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              <sn-time-ago timestamp="::item.updated_on"/>
          </div>   
      </div>
    	<div class="col-sm-12" ng-show="c.data.request.maximum_entries" style="padding:15px; text-align:center;">
          <a href="?id=requests"> ${View All Requests}</a>  
      </div>
  </div>

  <!-- Request Others Panel -->
  <div ng-if = "show_requestOth && c.data.requestOth.hasAny == true && !show_quicklink && !show_approvals && !show_request && !show_assigned" class="panels-container-requestsOth overflow-requests list-group">
    	<div class="list-group-item row" ng-repeat="item in c.data.requestOth.req_list" style="margin:0px;" >
      		<div class="col-xs-8" style="">
            <div>
             <a href="?id={{::item.url.id}}&table={{::item.url.table}}&sys_id={{::item.url.sys_id}}"> {{::item.display_field}} </a>
            </div>
            <small class="text-muted">
            	<div ng-repeat="f in item.secondary_displays">
            			<span>{{::f.display_value}}</span>
              </div>
            </small>
          </div>
         	<div class="col-xs-4">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              <sn-time-ago timestamp="::item.updated_on"/>
          </div>   
      </div>
    	<div class="col-sm-12" ng-show="c.data.request.maximum_entries" style="padding:15px; text-align:center;">
          <a href="?id=requests"> ${View All Requests}</a>  
      </div>
  </div>
    
    
  <!-- Approvals Panel -->
  <div class="panels-container-approval overflow-approvals" ng-if = "!show_request && !show_quicklink && !show_requestOth && !show_assigned">
        <div ng-repeat="approval in data.approvals.approval_list" class="sp-approval">
          <div class="row approval-rows" style="margin:0px">
          <div class="col-sm-9">
            <div ng-if="approval.task.number || approval.task.short_description">
              <a ng-href="?id=oc_approval&table=sysapproval_approver&sys_id={{::approval.sys_id}}" title="{{data.ViewApprovalPageMsg}}">
                <span ng-if="approval.task.number">{{::approval.task.number}}</span>
                <span ng-if="approval.task.number && approval.task.short_description"> - </span>
                <span ng-if="approval.task.short_description">{{::approval.task.short_description}}</span>
              </a>
            </div>
            <div ng-if="approval.task.opened_by"><label>${Requestor}</label> {{::approval.task.opened_by}}</div>
            <div ng-if="approval.task.approver"><label>${Approver}</label> {{::approval.task.approver}}</div>
            <div ng-if="approval.task.start_date"><label>${Start}</label> {{::approval.task.start_date}}</div>
            <div ng-if="approval.task.end_date"><label>${End}</label> {{::approval.task.end_date}}</div>
            <div ng-if="approval.task.quantity"><label>${Quantity}</label> {{::approval.task.quantity}}</div>
            <div ng-if="approval.task.price"><label>${Price}</label> {{::approval.task.price}}
              <span ng-if="approval.task.recurring_price"><label>${Recurring price}</label> {{::approval.task.recurring_price}} {{::approval.task.recurring_frequency}}</span>
              <label ng-if="approval.task.quantity && approval.task.quantity > 1"> ${each}</label>
            </div>
            <div ng-if="approval.items.length == 1">
              <div ng-repeat="item in approval.items">
                <div ng-if="item.variables.length > 0" ng-init="variable_toggle=false">
                  <a href="javascript:void(0)" ng-click="variable_toggle = !variable_toggle">
                    <span class="glyphicon"
                          ng-class="{'glyphicon-chevron-down': !variable_toggle, 'glyphicon-chevron-up': variable_toggle}">
                    </span>
                    ${Options}
                  </a>
                  <div ng-repeat="variable in item.variables" ng-if="variable_toggle">
                    <label class="text-muted">{{::variable.label}}</label>
                    <div>{{::variable.display_value}}</div>
                  </div>
                </div>
              </div>
            </div>

            <div ng-if="approval.variables.length > 0" ng-init="variable_toggle=false">
              <a href="javascript:void(0)" ng-click="variable_toggle = !variable_toggle">
                <span class="glyphicon"
                      ng-class="{'glyphicon-chevron-down': !variable_toggle, 'glyphicon-chevron-up': variable_toggle}">
                </span>
                ${Options}
              </a>
              <div ng-repeat="variable in approval.variables" ng-if="variable_toggle">
                <label>{{::variable.label}}</label>
                <div>{{::variable.display_value}}</div>
              </div>
            </div>
          </div>

          <div class="col-sm-3">
            <button name="approve" ng-if="approval.state == 'requested'" class="btn btn-primary btn-block" style="border-width:1px;" ng-click="approve(approval.sys_id);">${Approve}</button>
            <button name="reject" ng-if="approval.state == 'requested'" class="btn btn-default btn-block" ng-click="reject(approval.sys_id);">${Reject}</button>
          </div>
        </div>
       </div>
  			<div class="col-sm-12" ng-show="c.data.approvals.show_viewAll" style="padding:15px; text-align:center;">
          <a href="?id=approvals">${View All Approvals}</a>  
        </div>
  </div>

  <!-- Assignments Panel -->
  <div ng-if = "show_assigned && c.data.assigned.hasAny == true && !show_quicklink && !show_approvals && !show_request" class="panels-container-assigned overflow-requests list-group">
    	<div class="list-group-item row" ng-repeat="item in c.data.assigned.req_list" style="margin:0px;" >
      		<div class="col-xs-8" style="">
            <div>
             <a href="?id={{::item.url.id}}&table={{::item.url.table}}&sys_id={{::item.url.sys_id}}"> {{::item.display_field}} </a>
            </div>
            <small class="text-muted">
            	<div ng-repeat="f in item.secondary_displays">
            			<span>{{::f.display_value}}</span>
              </div>
            </small>
          </div>
         	<div class="col-xs-4">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              <sn-time-ago timestamp="::item.updated_on"/>
          </div>   
      </div>
    	<div class="col-sm-12" ng-show="c.data.assigned.maximum_entries" style="padding:15px; text-align:center;">
          <a href="?id=assigned"> ${View All Requests}</a>  
      </div>
  </div>
    
    
    
    
  </div> 
    
</div>]]></template>
    </sp_widget>
</record_update>
